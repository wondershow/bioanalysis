<!DOCTYPE html>
<meta charset="utf-8">

<link href="../src/nv.d3.css" rel="stylesheet" type="text/css">
<script>
	data_loaded = false;
	var x_field_index = null;
	var y_field_index = null;
	var z_field_index = null;
	var pnt_field_index = null;

	function read_csv() {
		alert("In Read CSV");
		d3.csv("",function(data) {console.log(data)});
	}

	function change_x() {
	     var sel = document.getElementById('x_axis');
	     x_field_index = sel.selectedIndex;
	}
	
	function change_y() {
	     var sel = document.getElementById('y_axis');
	     y_field_index = sel.selectedIndex;
	}
	
	function change_z() {
	     var sel = document.getElementById('z_axis');
	     z_field_index = sel.selectedIndex;
	}
	
	
	function change_pnt() {
	     var sel = document.getElementById('pnt_axis');
	     pnt_field_index = sel.selectedIndex;
	}

</script>


<style>

.fixedheight {
    width: 100%;
    height: 70%;
    background-color: #e0e0e0;
}

body {
  overflow-y:scroll;
  margin: 0;
  padding: 0;
}

svg {
  overflow: hidden;
}

div {
  border: 0;
  margin: 0;
}

/*
#offsetDiv {
  margin-left: 100px;
  margin-top: 100px;
}
*/


#test1 {
  margin: 0;
}alert(" x_field_index = " + x_field_index);
	}

</script>


<style>

.fixedheight {
    width: 100%;
    height: 70%;
    background-color: #e0e0e0;
}

body {
  overflow-y:scroll;
  margin: 0;
  padding: 0;
}

svg {
  overflow: hidden;
}

div {
  border: 0;
  margin: 0;
}

/*
#offsetDiv {
  margin-left: 100px;
  margin-top: 100px;
}
*/


#test1 {
  margin: 0;
}

#test1 svg {
  height: 500px;
}

</style>





<body>

<div id="offsetDiv" class="fixedheight">
  <div id="test1" class='with-3d-shadow with-transitions'>
    <svg></svg>
  </div>
</div>

<hr/>



</style>





<body>

<div id="offsetDiv" class="fixedheight">
  <div id="test1" class='with-3d-shadow with-transitions'>
    <svg></svg>
  </div>
</div>

<hr/>




<div >
	Please upload file : <input type="file" name="filedata" onchange="read_csv()">
	<br>
	Fields of data:
	<table >
	  	<tr>
			<th>FieldName</th>
			<th>ValueType</th>
	  	</tr>
	</table>	
	<div id="choose_x"> Choose data on X axis:</div>
	<hr />
	<div id="choose_y"> Choose data on Y axis:</div>
	<hr />
	<div id="choose_z"> Choose data on Z axis(optional):</div>
	<hr />
	<div id="choose_points"> Choose data on the coordinates:</div>
	<hr />
	<button type="button" id="createDigram">Draw</button>
	
	
</div>

<script src="../lib/d3.v3.js"></script>
<!--<script src="../lib/fisheye.js"></script>-->
<script src="../nv.d3.js"></script>
<script src="../src/tooltip.js"></script>
<script src="../src/utils.js"></script>
<script src="../src/models/legend.js"></script>x
<script src="../src/models/axis.js"></script>
<script src="../src/models/distribution.js"></script>
<script src="../src/models/scatter.js"></script>
<script src="../src/models/scatterChart.js"></script>
<script>




  //To create the selecting paz_field_indexrt
  fieldNames = [ "CaseNum",	
				 "NucCount",	
				 "PH3",	
				 "KI67",
				 "UpGrade",	
				 "UpNot",
			   	 "Grade",
				 "Notin",
                 "gland",
                 "mi",
				 "checkNot",
				 "pt",
                 "t",
                 "Stages",
                 "Race",
				 "ER",
                 "PR",
                 "HER2",
				 "HER2Status",
				 "TN",
				 "Age",
				 "Tstage",
 				 "Nstage",
				 "Final_Grade",
				 "Final_Not",
				 "MFI",
				 "AdjustedNot",
				 "KI67_Percent",
				 "PH3_Percent",
				 "Adjusted1"];

  //too choose which part shows up in the x axis
  var select  = d3.select("#choose_x")
			.append("select")
			.attr("id","x_axis")
			.on("change", change_x);
  options = select.selectAll('option').data(fieldNames); // Data join
  options.enter().append("option").text(function(d) { return d; });

  //too choose which part shows up in the x axis
  var select1  = d3.select("#choose_y")
			.append("select")
			.attr("id","y_axis")
			.on("change", change_y);
  options1 = select1.selectAll('option').data(fieldNames); // Data join
  options1.enter().append("option").text(function(d) { return d; });

  //too choose which part shows up in the x axis
  var select2  = d3.select("#choose_z")
			.append("select")
			.attr("id","z_axis")
			.on("change", change_z);
  options2 = select.selectAll('option').data(fieldNames); // Data join
  options2.enter().append("option").text(function(d) { return d; });
  
  //too choose which part shows up in the x axis
  var select3  = d3.select("#choose_x")
			.append("select")
			.attr("id","pnt_axis")
			.on("change", change_pnt);
  options3 = select3.selectAll('option').data(fieldNames); // Data join
  options3.enter().append("option").text(function(d) { return d; });




//Format A
var chart;
nv.addGraph(function() {
  chart = nv.models.scatterChart()
                .showDistX(true)
                .showDistY(true)
                .useVoronoi(true)
                .color(d3.scale.category10().range())
                .transitionDuration(300)
                ;

  chart.xAxis.tickFormat(d3.format('.02f'));
  chart.yAxis.tickFormat(d3.format('.02f'));
  chart.tooltipContent(function(key) {
      return '<h2>' + key + '</h2>';
  });








  d3.select('#test1 svg').datum(randomData(5,50)).call(chart);

  nv.utils.windowResize(chart.update);

  chart.dispatch.on('stateChange', function(e) { ('New State:', JSON.stringify(e)); });

  return chart;
});


function randomData(groups, points) { //# groups,# points per group
  var data = [],
      shapes = ['circle', 'cross', 'triangle-up', 'triangle-down', 'diamond', 'square'],
      random = d3.random.normal();

  for (i = 0; i < groups; i++) {
    data.push({
      key: 'Group ' + i,
      values: []
    });

  for (j = 0; j < points; j++) {
     data[i].values.push({
        x: random(), 
        y: random(), 
        size: Math.random(), 
        shape: shapes[j % 6]
      });
    }
  }
  console.log(data);
  return data;
}

</script>
